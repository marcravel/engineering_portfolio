---
interface Props {
  project: {
    id: number;
    category: string;
    title: string;
    techStack: string[];
    description: string;
    achievements?: string;
    image?: string;
    slug?: string;
  }
}

const { project } = Astro.props;
const imageUrl = project.image || 'https://images.unsplash.com/photo-1518770660439-4636190af475?auto=format&fit=crop&w=800&q=80';
const projectLink = project.slug ? `/projects/${project.slug}` : `/projects/${project.id}`;
const cardStyle = `background-image: linear-gradient(to bottom, rgba(15, 23, 42, 0.7) 0%, rgba(15, 23, 42, 0.95) 100%), url('${imageUrl}'); background-size: cover; background-position: center; min-height: 400px;`;
---

<div class="col-md-6 col-lg-4 pb-4">
    <a href={projectLink} class="text-decoration-none d-block h-100">
        <div class="card h-100 project-card border-0 shadow-sm" style={cardStyle}>
            <div class="radar-scan"></div>
            <div class="card-body d-flex flex-column proj-body position-relative z-1 p-4">
                <div class="mb-3">
                    <span class="badge bg-primary bg-opacity-75 px-3 py-2 border border-light border-opacity-25">{project.category}</span>
                </div>
                <h5 class="card-title text-white fw-bold fs-4 mb-3">{project.title}</h5>
                <p class="card-text small mb-auto text-light opacity-75">
                    <strong class="text-white">{project.techStack.join(', ')}</strong><br/><br/>
                    {project.description}
                </p>
                {project.achievements && (
                    <div class="mt-4 p-3 rounded bg-dark bg-opacity-50 border border-secondary border-opacity-25">
                        <p class="small mb-0" style="color: var(--color-gold); font-weight: 600;">
                            {project.achievements}
                        </p>
                    </div>
                )}
            </div>
        </div>
    </a>
</div>

<style>
/* Radar sweep container inside the card */
.project-card {
    position: relative;
    overflow: hidden;
    /* Retain original shadow on hover from style.css, but add some border radius */
    border-radius: var(--radius-md); 
    transition: transform 0.3s ease, box-shadow 0.3s ease;
}

.project-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 10px 25px rgba(0,0,0,0.4) !important;
}

/* The scanning line pseudo-elements */
.radar-scan {
    position: absolute;
    top: 0; left: 0; right: 0; bottom: 0;
    pointer-events: none;
    z-index: 0;
    opacity: 0;
    transition: opacity 0.3s;
}

/* On hover, fade in the scan and start animation */
.project-card:hover .radar-scan {
    opacity: 1;
}

.radar-scan::after {
    content: '';
    position: absolute;
    top: -50%;
    left: 0;
    width: 200%;
    height: 10px;
    background: linear-gradient(to top, rgba(30, 58, 138, 0), rgba(100, 150, 255, 0.4), rgba(30, 58, 138, 0));
    box-shadow: 0 0 10px rgba(100, 150, 255, 0.3);
    transform: rotate(25deg);
    animation: radar-sweep 2.5s infinite linear;
    display: none;
}

.project-card:hover .radar-scan::after {
    display: block;
}

@keyframes radar-sweep {
    0% {
        transform: translateY(-50%) rotate(25deg);
    }
    100% {
        transform: translateY(200%) rotate(25deg);
    }
}
</style>
